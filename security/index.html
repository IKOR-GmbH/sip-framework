<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="IKOR">
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Security - SIP Framework Documentation</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  <link href="../css/extra.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Security";
    var mkdocs_page_input_path = "security.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> SIP Framework Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Introduction</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation Guide</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../archetype/">Archetype</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../core/">Core</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../middle-component/">Middle Component</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../integration-starter/">Integration Starter</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../starter-parent/">Starter Parent</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Security</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#dependency">Dependency</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#contents">Contents</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#additional-information">Additional information</a>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../license/">License</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../contributing/">Contribution Guidelines</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../changelog/">Changelog</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="" href="../javadoc/latest/index.html">JavaDoc of latest Release</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="" href="https://ikor.one">Find out more about IKOR</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">SIP Framework Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Security</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/IKOR-GmbH/sip-framework/edit/main/docs/security.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h2 id="sip-security">SIP Security<a class="headerlink" href="#sip-security" title="Permanent link">&para;</a></h2>
<h3 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h3>
<p><strong>What is SIP Security?</strong>
SIP Security is built on top of Spring Security and is trying to ease and streamline the usage of Security related aspects,
but also add some enterprise grade features which are, from our perspective, quite relevant and helpful.</p>
<p><strong>Why use it?</strong>
Implementing code and configuration on top of Spring Security should help you jump-start your adapter development
(along with the archetype), not waste your time, and enable you to focus on your core tasks - resolving integration problems.
Nowadays, security is one of the most important topics in every application. Therefore, we decided to add SIP Security
in every archetype-generated adapter project.</p>
<h3 id="dependency">Dependency<a class="headerlink" href="#dependency" title="Permanent link">&para;</a></h3>
<pre><code class="language-xml">    &lt;dependency&gt;
        &lt;groupId&gt;de.ikor.sip.foundation&lt;/groupId&gt;
        &lt;artifactId&gt;sip-security&lt;/artifactId&gt;
    &lt;/dependency&gt;
</code></pre>
<h3 id="contents">Contents<a class="headerlink" href="#contents" title="Permanent link">&para;</a></h3>
<p>Following description shows SIP Security functionalities and configuration.</p>
<ul>
<li><strong>SSL</strong> (by default turned off; activated by setting a server side certificate or turning the client SSL explicitly on and optionally setting a client certificate; if no server certificate is set a client certificate is mandatory)<ul>
<li>Client (our application is consuming APIs using the provided certificate)
    <code>yaml
    sip.security:
        ssl:
            client:
                enabled: true #true / false (default); if enabled but no other configs are made, server keystore is used as client certificate
                key-store: classpath:keystore.p12 # possible resource strings are classpath:, file:, http:, _none_
                key-store-password: password # we recommend to use env_vars or sealed secrets
                key-store-type: pkcs12 #possible options are pkcs12, jks, jceks
                key-alias: springboot #the alias of the key to be chosen from the container
                key-password: password # we recommend to use env_vars or sealed secrets</code>
    To turn the usage of a specific client certificate off (default):
    <code>yaml
    sip.security:
        ssl:
            client:
                enabled: false</code>
    The truststore is handled with Java default:
        1. set the cacerts in the runtime accordingly (preferrable approach)
        2. for local development you could add any certificate, IntermediateCA, RootCA or complete certificate chain to the keystore as a trusted certificate (e.g. by importing it with tools like keytool) - a possible command could be:
        <code>yaml
            keytool -importcert -file certificate.cer -keystore keystore.jks -alias "Alias"</code></li>
<li>Server (our application is providing APIs using the provided certificate)
     <code>yaml
    sip.security:
        ssl:
            server:
                key-store: classpath:keystore.p12 # possible resource strings are classpath:, file:, http:, _none_
                key-store-password: password # we recommend to use env_vars or sealed secrets
                key-store-type: pkcs12 #possible options are pkcs12, jks, jceks
                key-alias: springboot #the alias of the key to be chosen from the container
                key-password: password # we recommend to use env_vars or sealed secrets</code>
    To turn the usage of the server certificate off:
    <code>yaml
    sip.security:
        ssl:
            server:
                enabled: false</code></li>
</ul>
</li>
<li><strong>Authentication</strong>
     Global authentication configuration:
    <code>yaml
    sip.security:
        authentication:
            enabled: true #turn on/off all authentication functionality
            disable-csrf: true
            ignored-endpoints: #a list of endpoints which are ignored by ALL authenticators based on Spring´s AntPathMatchers implementation
            - /actuator
            - /actuator/**
            - /favicon.ico</code><ul>
<li><u>Extractors</u> (extract the relevant token from an http-requests)<ul>
<li>BasicAuth: Extracts the BasicAuth credentials from the request</li>
<li>X509: Extracts the X509 certificate from the request</li>
</ul>
</li>
<li><u>Providers</u> (triggers a Validator to validate a given authentication)<ul>
<li>BasicAuth: Takes the extracted basic auth token and uses the given validator from the configuration to validate the token</li>
<li>X509: Takes the extracted X509 token and uses the given validator from the configuration to validate the token</li>
</ul>
</li>
<li><u>Validators</u> (validates a given token)<ul>
<li>BasicAuth
    Configuration:
    <code>yaml
    sip.security:
        authentication:
            enabled: true #turn on/off all authentication functionality
            auth-providers:
                - classname: de.ikor.sip.foundation.security.authentication.basic.SIPBasicAuthAuthenticationProvider
                  ignored-endpoints: #a list of endpoints which are ignored by this specific authenticator based on Spring´s AntPathMatchers implementation
                    - /actuator/health
                    - /actuator/env
                  validation:
                    classname: de.ikor.sip.foundation.security.authentication.basic.SIPBasicAuthFileValidator #FQCN of the validator to be used
                    file-path: classpath:basic-auth-users.json  # possible resource strings are classpath:, file:, http:, _none_</code>
    Sample file "basic-auth-users.json":
    <code>json
    [
        {"username": "user1", "password": "pw1"},
        {"username": "anotherUser", "password": "anotherPassword"}
    ]</code></li>
<li>X509
    Configuration:
    <code>yaml
    sip.security:
        authentication:
            enabled: true  #turn on/off all authentication functionality
            auth-providers:
                - classname: de.ikor.sip.foundation.security.authentication.x509.SIPX509AuthenticationProvider
                  ignored-endpoints: #a list of endpoints which are ignored by this specific authenticator based on Spring´s AntPathMatchers implementation
                    - /favicon.ico
                    - /actuator/env
                  validation:
                    classname: de.ikor.sip.foundation.security.authentication.x509.SIPX509FileValidator #FQCN of the validator to be used
                    file-path: classpath:client-certs.acl  # possible resource strings are classpath:, file:, http:, _none_</code>
    Sample file "client-certs.acl":
    <code>CN=Full Name, EMAILADDRESS=name@domain.de, O=[*], C=DE
    CN=Full Name2, EMAILADDRESS=name2@domain.de, O=[*], C=DE</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="additional-information">Additional information<a class="headerlink" href="#additional-information" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><em>ACL</em> in the context of SIP Security and X509 is our implementation of an <em>Access Control List</em>.
  SIPX509FileValidator uses a given .acl file to grant access to respective users. This SIP specific feature is not related to <a href="https://docs.spring.io/spring-security/site/docs/3.0.x/reference/domain-acls.html">Spring Security´s ACL</a> implementation.
  The high-level intention is to limit the access to the provided API. If this feature is used client certificates are needed.</p>
</li>
<li>
<p>To set the password for configuration value <em>sip.security.ssl.server.key-store-password</em> by env_var:</p>
<blockquote>
<p>export SIP_SECURITY_SSL_SERVER_KEY_STORE_PASSWORD ="password"</p>
</blockquote>
<p>Spring will automatically find the correct variable and set the value.</p>
</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../license/" class="btn btn-neutral float-right" title="License">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../starter-parent/" class="btn btn-neutral" title="Starter Parent"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/IKOR-GmbH/sip-framework/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../starter-parent/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../license/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>

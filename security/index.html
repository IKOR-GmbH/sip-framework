<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="IKOR">
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Security - SIP Framework Documentation</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  <link href="../css/extra.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Security";
    var mkdocs_page_input_path = "security.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> SIP Framework Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Introduction</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation Guide</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../archetype/">Archetype</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../core/">Core</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../middle-component/">Middle Component</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../integration-starter/">Integration Starter</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../starter-parent/">Starter Parent</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Security</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#dependency">Dependency</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#contents">Contents</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#ssl">SSL</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#authentication">Authentication</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#additional-information">Additional information</a>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../test-kit/">Test Kit</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../license/">License</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING/">Contribution Guidelines</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../CODE_OF_CONDUCT/">Code Of Conduct</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../changelog/">Changelog</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="" href="../javadoc/latest/index.html">JavaDoc Latest Development</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="" href="../javadoc/2.0.0/index.html">JavaDoc 2.0.0</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="" href="../javadoc/1.0.0/index.html">JavaDoc 1.0.0</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="" href="https://ikor.one/produkt/system-integration-platform">Find out more about IKOR</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="" href="https://ikor.one/impressum/">Impressum</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">SIP Framework Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Security</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/IKOR-GmbH/sip-framework/edit/main/docs/security.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h2 id="sip-security">SIP Security<a class="headerlink" href="#sip-security" title="Permanent link">&para;</a></h2>
<div class="toc">
<ul>
<li><a href="#sip-security">SIP Security</a><ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#dependency">Dependency</a></li>
<li><a href="#contents">Contents</a><ul>
<li><a href="#ssl">SSL</a></li>
<li><a href="#authentication">Authentication</a></li>
</ul>
</li>
<li><a href="#additional-information">Additional information</a></li>
</ul>
</li>
</ul>
</div>
<h3 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h3>
<p><strong>What is SIP Security?</strong>
SIP Security is built on top of Spring Security and is trying to ease and streamline the usage of Security related aspects,
but also add some enterprise grade features which are, from our perspective, quite relevant and helpful.</p>
<p><strong>Why use it?</strong>
Nowadays, security is one of the most important topics in every application.
Implementing code and configuration on top of Spring Security should help you jump-start your adapter development
(along with the archetype), not waste your time, and enable you to focus on your core tasks - resolving integration problems.</p>
<h3 id="dependency">Dependency<a class="headerlink" href="#dependency" title="Permanent link">&para;</a></h3>
<pre class="highlight"><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;de.ikor.sip.foundation&lt;/groupId&gt;
    &lt;artifactId&gt;sip-security&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
<p>SIP Security dependency is included by default when creating adapter with SIP Archetype.</p>
<h3 id="contents">Contents<a class="headerlink" href="#contents" title="Permanent link">&para;</a></h3>
<p>Following description shows SIP Security functionalities and configuration.</p>
<h4 id="ssl">SSL<a class="headerlink" href="#ssl" title="Permanent link">&para;</a></h4>
<p>SSL is by default turned off. It can be activated by setting a server side certificate or turning the client SSL explicitly 
on and optionally setting a client certificate. If no server certificate is set a client certificate is mandatory when turning on client SSL.</p>
<ul>
<li>
<p>Client (our application is consuming APIs using the provided certificate)
  <pre class="highlight"><code class="language-yaml">sip.security:
    ssl:
        client:
            enabled: true #true / false (default); if enabled but no other configs are made, server keystore is used as client certificate
            key-store: classpath:keystore.p12 # possible resource strings are classpath:, file:, http:, _none_
            key-store-password: password # we recommend to use env_vars or sealed secrets
            key-store-type: pkcs12 #possible options are pkcs12, jks, jceks
            key-alias: springboot #the alias of the key to be chosen from the container
            key-password: password # we recommend to use env_vars or sealed secrets</code></pre>
  To turn the usage of a specific client certificate off (default):
  <pre class="highlight"><code class="language-yaml">sip.security:
    ssl:
        client:
            enabled: false</code></pre>
  The truststore is handled with Java default:</p>
<ul>
<li>set the cacerts in the runtime accordingly (preferable approach)</li>
<li>for local development you could add any certificate, IntermediateCA, RootCA or complete certificate chain to the 
  keystore as a trusted certificate (e.g. by importing it with tools like keytool), a possible command could be:
  <code>keytool -importcert -file certificate.cer -keystore keystore.jks -alias "Alias"</code></li>
</ul>
</li>
<li>
<p>Server (our application is providing APIs using the provided certificate)
  <pre class="highlight"><code class="language-yaml">sip.security:
    ssl:
        server:
            key-store: classpath:keystore.p12 # possible resource strings are classpath:, file:, http:, _none_
            key-store-password: password # we recommend to use env_vars or sealed secrets
            key-store-type: pkcs12 #possible options are pkcs12, jks, jceks
            key-alias: springboot #the alias of the key to be chosen from the container
            key-password: password # we recommend to use env_vars or sealed secrets
            client-auth: want # Could be: need (client auth is mandatory), want (client auth is is wanted but not 
            # mandatory) and none (default)</code></pre>
  To turn the usage of the server certificate off:
  <pre class="highlight"><code class="language-yaml">sip.security:
    ssl:
        server:
            enabled: false</code></pre></p>
</li>
</ul>
<h4 id="authentication">Authentication<a class="headerlink" href="#authentication" title="Permanent link">&para;</a></h4>
<p>Global authentication configuration:</p>
<pre class="highlight"><code class="language-yaml">sip.security:
    authentication:
        disable-csrf: true
        ignored-endpoints: #a list of endpoints which are ignored by ALL authenticators based on Spring´s AntPathMatchers implementation
        - /actuator
        - /actuator/**
        - /favicon.ico</code></pre>
<ul>
<li><u>Extractors</u> (extract the relevant token from an http-requests)<ul>
<li>BasicAuth: Extracts the BasicAuth credentials from the request</li>
<li>X509: Extracts the X509 certificate from the request (requires sip.security.ssl.server.client-auth set to need or want)</li>
</ul>
</li>
<li><u>Providers</u> (triggers a Validator to validate a given authentication)<ul>
<li>BasicAuth: Takes the extracted basic auth token and uses the given validator from the configuration to validate the token</li>
<li>X509: Takes the extracted X509 token and uses the given validator from the configuration to validate the token</li>
</ul>
</li>
<li><u>Validators</u> (validates a given token)<ul>
<li>BasicAuth
  <pre class="highlight"><code class="language-yaml">sip.security:
    authentication:
        auth-providers: #authentication functionality is enabled if valid providers are defined
            - classname: de.ikor.sip.foundation.security.authentication.basic.SIPBasicAuthAuthenticationProvider
              ignored-endpoints: #a list of endpoints which are ignored by this specific authenticator based on Spring´s AntPathMatchers implementation
                - /actuator/health
                - /actuator/env
              validation:
                classname: de.ikor.sip.foundation.security.authentication.basic.SIPBasicAuthFileValidator #FQCN of the validator to be used
                file-path: classpath:basic-auth-users.json  # possible resource strings are classpath:, file:, http:, _none_</code></pre>
  Sample file <code>basic-auth-users.json</code>:
  <pre class="highlight"><code class="language-json">[
    {"username": "user1", "password": "pw1"},
    {"username": "anotherUser", "password": "anotherPassword"}
]</code></pre></li>
</ul>
</li>
<li>X509 Configuration:
    <pre class="highlight"><code class="language-yaml">sip.security:
    authentication:
        auth-providers: #authentication functionality is enabled if valid providers are defined
            - classname: de.ikor.sip.foundation.security.authentication.x509.SIPX509AuthenticationProvider
              ignored-endpoints: #a list of endpoints which are ignored by this specific authenticator based on Spring´s AntPathMatchers implementation
                - /favicon.ico
                - /actuator/env
              validation:
                classname: de.ikor.sip.foundation.security.authentication.x509.SIPX509FileValidator #FQCN of the validator to be used
                file-path: classpath:client-certs.acl  # possible resource strings are classpath:, file:, http:, _none_</code></pre>
    Sample file <code>client-certs.acl</code>:
    <pre class="highlight"><code class="language-text">CN=Full Name, EMAILADDRESS=name@domain.de, O=[*], C=DE
CN=Full Name2, EMAILADDRESS=name2@domain.de, O=[*], C=DE</code></pre></li>
</ul>
<h3 id="additional-information">Additional information<a class="headerlink" href="#additional-information" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><em>ACL</em> in the context of SIP Security and X509 is our implementation of an <em>Access Control List</em>.
  <code>SIPX509FileValidator</code> uses a given .acl file to grant access to respective users. This SIP specific feature is not related to <a href="https://docs.spring.io/spring-security/site/docs/3.0.x/reference/domain-acls.html">Spring Security´s ACL</a> implementation.
  The high-level intention is to limit the access to the provided API. If this feature is used client certificates are needed.</p>
</li>
<li>
<p>To set the password for configuration value <code>sip.security.ssl.server.key-store-password</code> by environment variable you can do the following in your (bash) shell
  (Spring will automatically find the correct variable and set the value):</p>
<blockquote>
<p><code>export SIP_SECURITY_SSL_SERVER_KEY_STORE_PASSWORD="password"</code></p>
</blockquote>
</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../test-kit/" class="btn btn-neutral float-right" title="Test Kit">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../starter-parent/" class="btn btn-neutral" title="Starter Parent"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>© Copyright 2021, <a href="https://ikor.one">IKOR GmbH</a> & contributors</p>
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/IKOR-GmbH/sip-framework/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../starter-parent/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../test-kit/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../javascript/javadoc_menu_dropdown.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>

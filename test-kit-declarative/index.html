<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="IKOR" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>SIP Test Kit (with Declarative Structure) - SIP Framework Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../css/extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "SIP Test Kit (with Declarative Structure)";
        var mkdocs_page_input_path = "test-kit-declarative.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> SIP Framework Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Introduction</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation Guide</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../archetype/">Archetype</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../core/">Core</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../middle-component/">Middle Component</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../integration-starter/">Integration Starter</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../starter-parent/">Starter Parent</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../security/">Security</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../test-kit/">Test Kit</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../framework_version_upgrade/">Framework Version Upgrade</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../license/">License</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING/">Contribution Guidelines</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../CODE_OF_CONDUCT/">Code Of Conduct</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../changelog/">Changelog</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../javadoc/latest/index.html">JavaDoc Latest Development</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../javadoc/3.1.0/index.html">JavaDoc 3.1.0</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../javadoc/3.0.0/index.html">JavaDoc 3.0.0</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../javadoc/2.4.0/index.html">JavaDoc 2.4.0</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../javadoc/2.3.0/index.html">JavaDoc 2.3.0</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../javadoc/2.2.0/index.html">JavaDoc 2.2.0</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../javadoc/2.1.0/index.html">JavaDoc 2.1.0</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../javadoc/2.0.2/index.html">JavaDoc 2.0.2</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../javadoc/2.0.0/index.html">JavaDoc 2.0.0</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../javadoc/1.0.0/index.html">JavaDoc 1.0.0</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="https://ikor.one/produkt/system-integration-platform">Find out more about IKOR</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="https://ikor.one/impressum/">Impressum</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">SIP Framework Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
      <li>SIP Test Kit (with Declarative Structure)</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/IKOR-GmbH/sip-framework/edit/main/docs/test-kit-declarative.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="sip-test-kit-with-declarative-structure">SIP Test Kit (with Declarative Structure)<a class="headerlink" href="#sip-test-kit-with-declarative-structure" title="Permanent link">&para;</a></h1>
<div class="toc">
<ul>
<li><a href="#sip-test-kit-with-declarative-structure">SIP Test Kit (with Declarative Structure)</a></li>
<li><a href="#description">Description</a></li>
<li><a href="#features">Features</a><ul>
<li><a href="#new-test-case-definition-parameter-connectorid">New test case definition parameter (connectorId)</a></li>
<li><a href="#automatic-conversion-to-pojo-data-model-in-connectors">Automatic conversion to POJO data model in Connectors</a></li>
<li><a href="#skip-camel-input-component">Skip Camel input component</a></li>
</ul>
</li>
</ul>
</div>
<h1 id="description">Description<a class="headerlink" href="#description" title="Permanent link">&para;</a></h1>
<p>Using Test Kit with <strong>Declarative Structure</strong> is explained here and the content of this file should be treated as 
extension of base documentation
<a href="https://ikor-gmbh.github.io/sip-framework/test-kit/">SIP Test Kit</a>.</p>
<p>Understanding material from the suggested link is a <strong>prerequisite</strong>!</p>
<h1 id="features">Features<a class="headerlink" href="#features" title="Permanent link">&para;</a></h1>
<h3 id="new-test-case-definition-parameter-connectorid">New test case definition parameter (connectorId)<a class="headerlink" href="#new-test-case-definition-parameter-connectorid" title="Permanent link">&para;</a></h3>
<p>Main addition is expansion of test case definition. In version 2 is possible to write test definitions only by using
<code>endpointId</code>. Version 3 introduced <strong>Declarative Structure</strong> and <strong>Connectors</strong> which are wrapping input and output endpoints.
In that manner, it is natural for Test Kit to enable creating test definitions with <code>connectorId</code> as well. Keep in
mind that using <code>connectorId</code> is possible only if <strong>Declarative Structure</strong> is enabled.</p>
<p>Both approaches can be used and combined within one test case definition, but for different endpoints!</p>
<p>That means you have to provide either <code>endpointId</code> or <code>connectorId</code> for one element within any of the test definition 
sections (<code>when-execute</code>, <code>with-mocks</code>, <code>then-expect</code>).</p>
<p>For example, this is possible:</p>
<pre class="highlight"><code class="language-yaml">{
   "title": "Correct test case definition example",
   "when-execute": {
      "connectorId": "rest_connector",                  # input connector which targets its input endpoint
      "with": {
        "body": "Hello World"
      }
   },
   "with-mocks": [
      {
         "endpointId": "custom_processor_endpoint_id",
         "returning": {
            "body": "Good afternoon World"
         }
      }
   ],
   then-expect:
     - connectorId: "rest_connector"
       having:
         body: "Good afternoon World"
}</code></pre>
<p>But, using both parameters <code>endpointId</code> and <code>connectorId</code> for same element is not possible:</p>
<pre class="highlight"><code class="language-yaml">{
   "title": "Correct test case definition example",
   "when-execute": {
      "connectorId": "rest_connector",                          # wrong, choose only one
      "endpointId": "endpoint_id",                              # wrong, choose only one
      "with": {
        "body": "Hello World"
      }
   },
   "with-mocks": [
      {
        "connectorId": "jms_connector",                         # wrong, choose only one
         "endpointId": "custom_processor_endpoint_id",          # wrong, choose only one
         "returning": {
            "body": "Good afternoon World"
         }
      }
   ],
   then-expect:
     - endpointId: "rest_connector_endpoint_id"
       having:
         body: "Good afternoon World"
}</code></pre>
<p><strong>Important note:</strong></p>
<p>If some external endpoints are written directly in Camel code and without using appropriate Connector, these endpoints
can be approached from test case definition only directly by using <code>endpointId</code>.</p>
<h3 id="automatic-conversion-to-pojo-data-model-in-connectors">Automatic conversion to POJO data model in Connectors<a class="headerlink" href="#automatic-conversion-to-pojo-data-model-in-connectors" title="Permanent link">&para;</a></h3>
<p>There is automatic conversion of given String JSON payload to the POJO object of <strong>Connector's</strong> data model. That is 
possible only for test case definition parts which are specified by using <code>connectorId</code>.
It is expected that correct format of JSON and correct payload are provided.</p>
<p>When using automatic conversions to POJO, different models are expected for different test definition sections:</p>
<ol>
<li>In <code>when-execute</code> section your JSON payload should match with InboundConnector <code>requestModel</code>.</li>
<li>In <code>with-mocks</code> section your JSON payload should match with OutboundConnector <code>responseModel</code>.</li>
<li>In <code>then-expect</code> section your JSON payload should match with InboundConnector <code>responseModel</code> when validating final
response or with OutboundConnector <code>requestModel</code> when validating payload on mocks.</li>
</ol>
<h3 id="skip-camel-input-component">Skip Camel input component<a class="headerlink" href="#skip-camel-input-component" title="Permanent link">&para;</a></h3>
<p>There is one more specific difference when using <code>endpointId</code> or <code>connectorId</code>, but only related to the
<code>when-execute</code> section.</p>
<p>When <code>endpointId</code> is used, testing payload is sent to the Camel consumer component (adapter's entry point) in 
InboundConnector. For this option, in most cases raw data payload should be sent, or data format which matches your 
Camel component transformation.</p>
<p>When <code>connectorId</code> is used, Camel consumer component (adapter's entry point) is skipped and testing payload is sent 
directly to the first processor of starting route in InboundConnector. For this option, in most cases matching 
JSON String payload should be sent.</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>© Copyright 2021, <a href="https://ikor.one">IKOR GmbH</a> & contributors</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/IKOR-GmbH/sip-framework" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../javascript/javadoc_menu_dropdown.js" defer></script>
      <script src="../javascript/copy_to_clipboard.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
